---
interface Props {
  story: {
    // story.slug (from getCollection) includes the language prefix (e.g., 'en/my-first-story')
    // story.id (from getCollection) also includes the language prefix (e.g., 'en/my-first-story')
    id: string; // We'll use this to derive the correct slug for the URL
    data: {
      title: string;
      description: string;
      image?: string;
    };
  };
  lang: string;
}

const { story, lang } = Astro.props;

// Calculate the actual slug needed for the URL, by removing the language prefix from story.id
// Example: If story.id is 'en/my-first-story', this will become 'my-first-story'
const storySlugForUrl = story.id.split('/').slice(1).join('/');
---
<a href={`/${lang}/stories/${storySlugForUrl}`} class="block bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 overflow-hidden">
  <img
    src={story.data.image || '/img/default-story-cover.jpg'}
    alt={story.data.title}
    class="w-full h-48 object-cover"
    loading="lazy"
  />
  <div class="p-5">
    <h3 class="text-xl font-bold text-gray-800 mb-2">{story.data.title}</h3>
    <p class="text-gray-600 text-sm line-clamp-3">{story.data.description}</p>
    <span class="mt-4 inline-block text-blue-600 hover:text-blue-800 font-semibold text-sm">Read Story &rarr;</span>
  </div>
</a>
